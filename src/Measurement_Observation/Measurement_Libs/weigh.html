<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

      <title>2.5.2. Weigh</title>
    
          <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../../../_static/theme.css " type="text/css" />
          <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
          <link rel="stylesheet" href="../../../_static/css/s4defs-roles.css" type="text/css" />
          <link rel="stylesheet" href="../../../_static/css/iframe.css" type="text/css" />
      
      <!-- sphinx script_files -->
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../../../_static/theme-vendors.js"></script> -->
      <script src="../../../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../../../genindex.html" />
  <link rel="search" title="Search" href="../../../search.html" />
  <link rel="next" title="2.5.3. Inspection-Testing" href="inspection-testing.html" />
  <link rel="prev" title="2.5.1. Criterion, Gauge, and Tasty-Bench" href="criterion.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../../../contents.html" class="home-link">
    
      <span class="site-name">Haskell Optimization Handbook</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../../../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../../contents.html#haskell-optimization-handbook">Table of Contents</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 ">
            
              <a href="../../Preliminaries/index.html" class="reference internal ">Preliminaries</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../index.html" class="reference internal ">Measurement, Profiling, and Observation</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../../Optimizations/index.html" class="reference internal ">Optimizations</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../../../contents.html">Docs</a> &raquo;</li>
    
      <li><a href="../index.html"><span class="section-number">2. </span>Measurement, Profiling, and Observation</a> &raquo;</li>
    
      <li><a href="index.html"><span class="section-number">2.5. </span>CPU Measurement : Haskell Libraries</a> &raquo;</li>
    
    <li><span class="section-number">2.5.2. </span><span class="incremental">Weigh</span></li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="criterion.html"
       title="previous chapter">← <span class="section-number">2.5.1. </span><span class="lightgrey">Criterion, Gauge, and Tasty-Bench</span></a>
  </li>
  <li class="next">
    <a href="inspection-testing.html"
       title="next chapter"><span class="section-number">2.5.3. </span><span class="lightgrey">Inspection-Testing</span> →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="weigh">
<h1><span class="section-number">2.5.2. </span><span class="incremental">Weigh</span><a class="headerlink" href="#weigh" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="https://hackage.haskell.org/package/weigh">Weigh</a> is a tiny Haskell package
to measure allocations of data constructors and functions. It provides a similar
interface to <span class="xref std std-ref">Criterion, Gauge, and Tasty-Bench</span> and is useful to confirm
that a data structure or function has the memory performance you anticipate it
to have at runtime.</p>
<section id="requirements">
<h2><span class="section-number">2.5.2.1. </span>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>The program must not be compiled with <code class="docutils literal notranslate"><span class="pre">-threaded</span></code>.</p></li>
<li><p>The program must not be compiled with profiling enabled.</p></li>
</ol>
<p>Weigh works by tracking the allocation and garbage collection behavior of the
runtime system, but it does so by taking snapshots before and after forcing
whatever value you are passing to it. Thus, it will report incorrect
measurements if another thread changes the heap unexpectedly. Similarly, it will
report larger results if the values are artificially inflated for profiling.</p>
</section>
<section id="what-information-do-i-receive-from-weigh">
<h2><span class="section-number">2.5.2.2. </span>What Information Do I Receive From Weigh?<a class="headerlink" href="#what-information-do-i-receive-from-weigh" title="Permalink to this heading">¶</a></h2>
</section>
<section id="when-should-i-use-weigh">
<h2><span class="section-number">2.5.2.3. </span>When should I use Weigh<a class="headerlink" href="#when-should-i-use-weigh" title="Permalink to this heading">¶</a></h2>
</section>
<section id="the-running-example">
<h2><span class="section-number">2.5.2.4. </span>The Running Example<a class="headerlink" href="#the-running-example" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="criterion.html"
       title="previous chapter">← <span class="section-number">2.5.1. </span><span class="lightgrey">Criterion, Gauge, and Tasty-Bench</span></a>
  </li>
  <li class="next">
    <a href="inspection-testing.html"
       title="next chapter"><span class="section-number">2.5.3. </span><span class="lightgrey">Inspection-Testing</span> →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2022-2022, Jeffrey Young (doyougnu).
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.8.0.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>